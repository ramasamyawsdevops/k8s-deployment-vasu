pipeline {
    agent any
    environment {
        AWS_ACCESS_KEY_ID = credentials('AWS_Access_Key')
        AWS_SECRET_ACCESS_KEY = credentials('AWS_Secret_Key')
        AWS_DEFAULT_REGION = 'ap-south-1'
    }

     stages {
        stage('GitClone')
		{
            
            steps {

				git branch: 'main', url: 'https://github.com/ramasamyawsdevops/k8s-deployment-vasu.git'

            }
        }
    
	 stage('Deploy Kubernates') 
	 {
		steps{
			script {
               sh 'aws eks --region ap-south-1 update-kubeconfig --name devcluster'
               sh 'kubectl apply -f ns.yaml'
			 // sh 'kubectl apply -f pvc.yaml'
			 // sh 'kubectl apply -f mongodb.yaml'
		   	  //sh 'kubectl apply -f newIngressctrl.yaml'
		   	  sh 'kubectl delete -f newIngressctrl.yaml'
			 // sh 'kubectl apply -f webcon.yaml'
			 sh 'kubectl delete -f webcon.yaml'
			  }      
          }
     }

     	
        
        
		 
    }

}
